<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <div t-name="mail.wip.widget.Composer" owl="1"
         class="o_mail_wip_composer"
         t-attf-class="{{options.avatar ? 'o_with_avatar' : ''}} {{options.chatter ? 'o_chatter_composer' : ''}}">
        <div t-if="options.avatar"
             class="o_sidebar">
            <img alt=""
                 class="o_avatar rounded-circle"
                 t-att-src="userAvatar"/>
        </div>

        <div class="o_core">

            <!-- New message composer -->
            <t t-if="options.chatter and !options.isLog">
                <!-- Text for followers -->
                <small class="o_wip_followers">
                    <b class="text-muted">To: </b>
                    <em class="text-muted">Followers of </em>
                    <b>
                        <t t-if="options.recordName">
                            &#32;&quot;<t t-esc="options.recordName"/>&quot;
                        </t>
                        <t t-if="!options.recordName">
                            this document
                        </t>
                    </b>
                </small>

                <!-- List of followers -->
                <div t-if="props.suggestedRecipients" class="o_composer_suggested_partners">
                    <div t-foreach="state.showAllSuggested ? props.suggestedRecipients : props.suggestedRecipients.slice(0, 2)" t-as="recipient"
                        t-attf-title="Add as recipient and follower (reason: #{recipient.reason})">
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox"
                                    class="custom-control-input"
                                    t-attf-id="_suggested_partners_#{recipient_index}"
                                    t-att-checked="recipient.checked ? 'checked' : undefined"
                                    t-att-data-fullname="recipient.full_name"/>
                            <label t-attf-for="_suggested_partners_#{recipient_index}" class="custom-control-label">
                                <t t-esc="recipient.name"/><t t-if="recipient.email_address"> (<t t-esc="recipient.email_address"/>)</t>
                            </label>
                        </div>
                    </div>
                    <t t-if='props.suggestedRecipients.length > 3'>

                        <a href="#" t-if="state.showAllSuggested" t-on-click="_onShowLess">
                            Show <t t-esc="props.suggestedRecipients.length - 3"/> less
                        </a>
                        <a href="#" t-else="" t-on-click="_onShowMore">
                            Show <t t-esc="props.suggestedRecipients.length - 3"/> more
                        </a>
                    </t>
                </div>
            </t>

            <div class="o_main">
                <t t-widget="Input"
                   t-ref="input"
                   class="o_input"
                   t-on-post-message="_onPostMessageInput"/>
                <div class="o_commands">
                    <t t-widget="EmojisButton"
                       class="o_command o_emojis"
                       t-on-emoji-selection="_onEmojiSelection"/>
                    <button class="o_command o_attachment_btn btn btn-secondary fa fa-paperclip"
                            aria-label="Add attachment"
                            title="Add attachment"
                            type="button"
                            t-on-click="_onClickAddAttachment"/>
                    <button t-if="options.sendButton"
                            class="o_command o_send btn btn-primary"
                            type="button"
                            t-on-click="_onClickSend">
                        <t t-if="options.isLog">Log</t><t t-else="">Send</t>
                    </button>
                </div>
            </div>
            <div t-if="showFooter"
                 class="o_footer">
                <t t-if="state.attachmentLIDs.length > 0"
                   t-widget="AttachmentList"
                   class="o_attachment_list"
                   attachmentLIDs="state.attachmentLIDs"
                   options="attachmentOptions"
                   t-on-unlink="_onUnlinkAttachment"
                   t-on-view="_onViewAttachment"/>
            </div>
            <input class="o_file_input d-none"
                   type="file"
                   multiple="true"
                   t-key="'fileInput'"
                   t-ref="fileInput"
                   t-on-change="_onChangeAttachment"/>
        </div>
    </div>

</templates>
