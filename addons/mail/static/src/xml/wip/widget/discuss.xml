<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <div t-name="mail.wip.widget.Discuss" owl="1"
         class="o_mail_wip_discuss"
         t-attf-class="{{ props.isMobile ? 'o_mobile' : ''}} {{ props.threadLID and props.isMobile and props.thread._model !== 'mail.box' ? 'o_fullscreen' : '' }}">
        <t t-if="props.isMobile">
            <!-- mobile layout -->
            <t t-if="!props.threadLID or props.thread._model === 'mail.box'">
                <!-- no thread or mailbox selection -->
                <t t-if="state.mobileNavbarTab === 'mailbox'"
                   t-widget="MobileMailboxSelection"
                   t-props="{ threadLID: props.threadLID }"
                   t-on-select-thread="_onSelectThread"/>
                <t t-if="state.mobileNavbarTab === 'mailbox'">
                    <t t-if="props.threadLID"
                       t-widget="Thread"
                       t-props="{ options: threadOptions, threadLID: props.threadLID }"
                       t-ref="'thread'"
                       t-on-redirect="_onRedirect"/>
                    <div t-else="" class="o_empty">No conversation.</div>
                </t>
                <t t-elif="!props.threadLID">
                   <t t-widget="ThreadPreviewList"
                      t-props="{ options: threadPreviewListOptions }"
                      t-on-select-thread="_onSelectThread"/>
                </t>
                <t t-widget="MobileNavbar"
                   t-props="{ active: state.mobileNavbarTab }"
                   t-on-select="_onSelectMobileNavbarTab"/>
            </t>
            <div t-else=""
                 class="o_content">
                <!-- chat/channel selection (mobile) -->
                <t t-widget="Thread"
                   t-props="{ options: threadOptions, threadLID: props.threadLID }"
                   t-ref="'thread'"
                   t-on-redirect="_onRedirect"
                   t-on-rendered="_onThreadRendered"/>
                <t t-if="showComposer"
                   t-widget="Composer"
                   t-props="{ threadLID: props.threadLID }"/>
            </div>
        </t>
        <t t-else="">
            <!-- desktop layout -->
            <t t-widget="Sidebar"
               t-props="{ threadLID: props.threadLID }"
               t-on-select-thread="_onSelectThread"/>
            <div class="o_content">
                <t t-if="props.threadLID">
                    <t t-widget="Thread"
                       t-props="{ options: threadOptions, threadLID: props.threadLID }"
                       t-ref="'thread'"
                       t-key="props.threadLID"
                       t-on-redirect="_onRedirect"
                       t-on-rendered="_onThreadRendered"/>
                    <t t-if="showComposer"
                       t-widget="Composer"
                       t-props="{ options: composerOptions, threadLID: props.threadLID }"/>
                </t>
            </div>
        </t>
    </div>

</templates>
